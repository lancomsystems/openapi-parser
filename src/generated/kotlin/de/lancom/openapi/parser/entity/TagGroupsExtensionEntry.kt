/*****************************************************************************
**   C A U T I O N                                                          **
**   This file is auto-generated!                                           **
**   If you want to make changes, please see the README.md file.            **
**   Please do not edit this file directly!                                 **
*****************************************************************************/
package de.lancom.openapi.parser.entity

import com.fasterxml.jackson.databind.annotation.JsonDeserialize
import com.fasterxml.jackson.databind.annotation.JsonSerialize
import de.lancom.openapi.common.types.*
import de.lancom.openapi.common.util.*
import de.lancom.openapi.parser.field.Field
import de.lancom.openapi.parser.jackson.EntityDeserializer
import de.lancom.openapi.parser.jackson.EntitySerializer
import de.lancom.openapi.parser.jackson.Parser
import de.lancom.openapi.parser.jackson.Wrapper

// hint:9A1BF04C
@Suppress("PropertyName")
@JsonSerialize(using = TagGroupsExtensionEntry.Companion.Serializer::class)
@JsonDeserialize(using = TagGroupsExtensionEntry.Companion.Deserializer::class)
data class TagGroupsExtensionEntry(
    val _name: Field<String?> = Field.unset(),
    val _tags: Field<List<String?>?> = Field.unset(),
    val __field_order: Set<Fields> = Fields.all,
) : Entity {

    ///////////////////////
    //
    // name
    //
    ///////////////////////

    // hint:3A7F9B2E
    val name: String?
        get() = _name.orNull

    // hint:F0C48D71
    fun setNameField(name: Field<String?>): TagGroupsExtensionEntry {
        return copy(_name = name)
            .updateFields()
    }

    // hint:8E56A4D9
    fun updateNameField(updater: (Field<String?>) -> Field<String?>): TagGroupsExtensionEntry {
        return setNameField(updater(_name))
    }

    // hint:B1D730FC
    fun updateName(updater: (String?) -> String?): TagGroupsExtensionEntry {
        return updateNameField { field ->
            field.flatMap { value ->
                Field(updater(value))
            }
        }
    }

    // hint:6542E98A
    fun mergeNameField(nameFieldToMerge: Field<String?>): TagGroupsExtensionEntry {
        return mergeName(nameFieldToMerge.orNull)
    }

    // hint:A8BC6F23
    fun mergeName(nameToMerge: String?): TagGroupsExtensionEntry {
        return if (nameToMerge == null) {
            this
        } else {
            val oldName = _name.orNull
            if (oldName == null) {
                setNameField(Field(nameToMerge))
            } else {
                // hint:2F684DAC
                setName(nameToMerge)
            }
        }
    }

    // hint:87B3E19C
    fun setName(name: String?): TagGroupsExtensionEntry {
        return setNameField(Field(name))
    }

    // hint:D465F782
    fun unsetName(): TagGroupsExtensionEntry {
        return setNameField(Field.unset())
    }

    // hint:47C9A0F6
    fun addName(name: String): TagGroupsExtensionEntry {
        if (this.name != null) {
            throw IllegalStateException("Field name of Entity TagGroupsExtensionEntry is already set to '${this.name}', refused to add new value '$name'")
        }
        return setName(name)
    }

    ///////////////////////
    //
    // tags
    //
    ///////////////////////

    // hint:3A7F9B2E
    val tags: List<String?>?
        get() = _tags.orNull

    // hint:F0C48D71
    fun setTagsField(tags: Field<List<String?>?>): TagGroupsExtensionEntry {
        return copy(_tags = tags)
            .updateFields()
    }

    // hint:8E56A4D9
    fun updateTagsField(updater: (Field<List<String?>?>) -> Field<List<String?>?>): TagGroupsExtensionEntry {
        return setTagsField(updater(_tags))
    }

    // hint:B1D730FC
    fun updateTags(updater: (List<String?>?) -> List<String?>?): TagGroupsExtensionEntry {
        return updateTagsField { field ->
            field.flatMap { value ->
                Field(updater(value))
            }
        }
    }

    // hint:6542E98A
    fun mergeTagsField(tagsFieldToMerge: Field<List<String?>?>): TagGroupsExtensionEntry {
        return mergeTags(tagsFieldToMerge.orNull)
    }

    // hint:A8BC6F23
    fun mergeTags(tagsToMerge: List<String?>?): TagGroupsExtensionEntry {
        return if (tagsToMerge == null) {
            this
        } else {
            val oldTags = _tags.orNull
            if (oldTags == null) {
                setTagsField(Field(tagsToMerge))
            } else {
                // hint:19DE5C87
                setTags((oldTags + tagsToMerge).distinct())
            }
        }
    }

    // hint:87B3E19C
    fun setTags(tags: List<String?>?): TagGroupsExtensionEntry {
        return setTagsField(Field(tags))
    }

    // hint:D465F782
    fun unsetTags(): TagGroupsExtensionEntry {
        return setTagsField(Field.unset())
    }

    // hint:3E9A8C01
    fun addTags(tags: List<String?>?): TagGroupsExtensionEntry {
        return setTags((this.tags ?: emptyList()) + (tags ?: emptyList()))
    }

    // hint:F7420EB5
    fun addTags(vararg tags: String): TagGroupsExtensionEntry {
        return addTags(tags.toList())
    }

    // hint:6A81E3FD
    override val entityDescriptor: EntityDescriptor by lazy {
        EntityDescriptor(
            entity = this,
            jsonNode = null,
            map = mapOf(
                "name" to _name,
                "tags" to _tags,
            ),
            flatMap = listOf(
            ),
            flatten = listOf(
            ),
            order = __field_order.map(Fields::value),
        )
    }

    // hint:49FE6A6F
    override fun toString(): String {
        return this.toYamlString(ignoreOrder = false)
    }

    // hint:20011A4E
    fun getFields(): Set<Fields> {
        val allFields: Set<Fields> = setOfNotNull(
            setOfNotNull<Fields>(
                if (_name.isDefined) Fields.name else null,
                if (_tags.isDefined) Fields.tags else null,
            ),
        ).flatten().toSet()
        // keep order
        return Fields.cleanupFields(__field_order.filter(allFields::contains).toSet() + allFields)
    }

    // hint:EFD0D818
    fun updateFields(): TagGroupsExtensionEntry {
        return copy(__field_order = getFields())
    }

    // hint:A0E5F382
    override fun mergeEntity(other: Entity?): TagGroupsExtensionEntry {
        return when (other) {
            null ->
                this

            is TagGroupsExtensionEntry ->
                merge(other)

            else ->
                TODO()
        }
    }

    // hint:D6150566
    fun mergeFields(other: TagGroupsExtensionEntry): TagGroupsExtensionEntry {
        return copy(
            __field_order = Fields.cleanupFields(this.__field_order + other.__field_order),
        ).updateFields()
    }

    // hint:716BFD54
    fun merge(other: TagGroupsExtensionEntry?): TagGroupsExtensionEntry {
        if (other == null) return this
        return this
            .mergeNameField(other._name)
            .mergeTagsField(other._tags)
            .mergeFields(other)
    }

    companion object : Parser<TagGroupsExtensionEntry> {

        data class Fields(val value: String) {
            val set: Set<Fields> = setOf(this)

            companion object {
                val name = Fields("name")
                val tags = Fields("tags")
                val all: Set<Fields> = setOf(
                    name,
                    tags,
                )
                val skip: Set<Fields> = setOf(
                )

                fun cleanupFields(fields: Iterable<Fields>): Set<Fields> {
                    return fields.filterNot(skip::contains).toSet() + all
                }

                fun fromWrapper(wrapper: Wrapper): Set<Fields> {
                    return cleanupFields(wrapper.fieldOrder.map(::Fields))
                }
            }
        }

        class Serializer : EntitySerializer<TagGroupsExtensionEntry>(TagGroupsExtensionEntry::class.java, TagGroupsExtensionEntry)
        class Deserializer : EntityDeserializer<TagGroupsExtensionEntry>(TagGroupsExtensionEntry::class.java, TagGroupsExtensionEntry)

        // hint:5F72B6D8
        override fun parseWrapper(wrapper: Wrapper): TagGroupsExtensionEntry {
            return TagGroupsExtensionEntry(
                _name = wrapper["name"].getNullOrElse {
                    getSingle {
                        getSingle {
                            getString()
                        }
                    }
                },
                _tags = wrapper["tags"].getNullOrElse {
                    getList {
                        getNullOrElse {
                            getString()
                        }
                    }
                },
                __field_order = Fields.all,
            )
        }
    }
}
